<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>SEA LIFE HUB | 海を中心とした暮らしの提案</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="サーフボード診断、アパレル、海沿い民泊の紹介など、海のある暮らしをもっと楽しく。" />
  <link rel="stylesheet" href="style.css" />
  <style>
    /* ====== このページ専用の上書き（白背景・シンプル） ====== */
    :root{ --page-max: 1100px; }
    body{ background:#fff; color:#111; }
    .site-header{ backdrop-filter:none; background:#ffffffcc; border-bottom:1px solid rgba(0,0,0,.06); }
    .header-spacer{ height:72px; }

    /* ヒーロー（シンプル） */
    .hero-top{ background:#f7fafc; padding:56px 16px; border-bottom:1px solid rgba(0,0,0,.06); }
    .hero-inner{ max-width:var(--page-max); margin:0 auto; text-align:center; }
    .hero-inner h1{ font-size:clamp(24px, 4.5vw, 42px); margin-bottom:10px; color:#0f172a; letter-spacing:.02em; }
    .hero-inner p{ font-size:clamp(14px, 2.2vw, 18px); color:#334155; line-height:1.8; margin:0 auto 16px; max-width:820px; }
    .hero-actions{ display:flex; gap:12px; justify-content:center; flex-wrap:wrap; margin-top:8px; }
    .btn.primary{ background:#0ea5e9; color:#fff; }
    .btn.outline{ border:1px solid #0ea5e9; color:#0ea5e9; background:#fff; }

    /* セクション共通 */
    .container{ max-width:var(--page-max); margin:0 auto; padding:28px 16px; }
    .section-title{ font-size:clamp(18px, 2.8vw, 24px); color:#0f172a; margin:0 0 12px; }
    .section-desc{ color:#475569; margin:0 0 16px; }

    /* 関連記事カード（4カラム小さめ） */
    .articles{ display:grid; gap:14px; grid-template-columns:repeat(4, 1fr); }
    @media (max-width:1024px){ .articles{ grid-template-columns:repeat(3, 1fr);} }
    @media (max-width:768px){ .articles{ grid-template-columns:repeat(2, 1fr);} }
    @media (max-width:520px){ .articles{ grid-template-columns:1fr;} }

    .article-card{
      border:1px solid rgba(0,0,0,.08); border-radius:12px; overflow:hidden; background:#fff;
      transition:transform .18s ease, box-shadow .18s ease; display:flex; flex-direction:column;
    }
    .article-card:hover{ transform:translateY(-2px); box-shadow:0 8px 22px rgba(0,0,0,.06); }

    .article-img-wrap{ aspect-ratio: 16/9; background:#e2e8f0; overflow:hidden; }
    .article-img{ width:100%; height:100%; object-fit:cover; display:block; }

    .article-body{ padding:10px 12px; display:flex; flex-direction:column; gap:6px; }
    .article-meta{ display:flex; gap:8px; align-items:center; color:#64748b; font-size:.82rem; }
    .badge{ display:inline-block; padding:2px 8px; border-radius:9999px; font-size:.72rem; background:#e2e8f0; color:#0f172a; }
    .article-title{ font-weight:700; color:#0f172a; line-height:1.45; font-size:clamp(14px, 2.2vw, 16px); min-height:2.8em; }
    .article-actions{ margin-top:auto; }
    .article-link{ display:inline-flex; align-items:center; gap:6px; padding:6px 10px; border-radius:10px; background:#0ea5e9; color:#fff; text-decoration:none; font-weight:600; font-size:.9rem; }
    .article-link:hover{ opacity:.92; }

    /* スケルトン */
    .skeleton{
      background:linear-gradient(90deg, #eceff3, #f5f7fa, #eceff3);
      background-size:200% 100%; animation:shine 1.1s linear infinite;
    }
    @keyframes shine{0%{background-position:200% 0}100%{background-position:-200% 0}}
    .sk-card{ border:1px solid rgba(0,0,0,.08); border-radius:12px; overflow:hidden; }
    .sk-img{ aspect-ratio:16/9; }
    .sk-body{ padding:10px 12px; display:grid; gap:8px; }
    .sk-line{ height:12px; border-radius:6px; }

    /* フッター（白背景用） */
    .site-footer{ background:#f8fafc; color:#475569; border-top:1px solid rgba(0,0,0,.06); }
  </style>
</head>
<body>
  <!-- ヘッダー（既存ナビと統一） -->
  <header class="site-header">
    <a href="index.html" class="logo">🌊 SEA LIFE HUB</a>
    <nav class="site-nav" aria-label="Primary">
      <a href="index.html" class="is-active">ホーム</a>
      <div class="dropdown">
        <button class="dropbtn" aria-haspopup="true" aria-expanded="false">メニュー ▾</button>
        <div class="dropdown-content" role="menu">
          <a href="diagnosis.html" role="menuitem">サーフボード診断</a>
          <a href="apparel.html" role="menuitem">アパレル（Tシャツ）</a>
          <a href="stays.html" role="menuitem">海沿い民泊</a>
        </div>
      </div>
      <a href="#related">関連記事</a>
    </nav>
    <button class="hamburger" aria-label="メニューを開く" aria-controls="mobileNav" aria-expanded="false"><span class="bar"></span></button>
  </header>
  <div class="header-spacer"></div>

  <!-- モバイルナビ -->
  <div class="mobile-nav-backdrop" id="backdrop"></div>
  <nav class="mobile-nav" id="mobileNav" aria-label="Mobile">
    <div class="mobile-title">🌊 SEA LIFE HUB</div>
    <a href="index.html" class="is-active">ホーム</a>
    <a href="diagnosis.html">サーフボード診断</a>
    <a href="apparel.html">アパレル（Tシャツ）</a>
    <a href="stays.html">海沿い民泊</a>
    <a href="#related">関連記事</a>
  </nav>

  <!-- シンプル・ヒーロー -->
  <section class="hero-top">
    <div class="hero-inner">
      <h1>海のある暮らしを、もっと自由に。</h1>
      <p>
        SEA LIFE HUB は、サーフボード診断やアパレル、海沿い民泊の紹介など、<br>
        ちょうどいい海ライフの入口をまとめたミニポータルです。
      </p>
      <div class="hero-actions">
        <a class="btn primary" href="diagnosis.html">サーフボードを診断する</a>
        <a class="btn outline" href="#related">関連記事を読む</a>
      </div>
    </div>
  </section>

  <!-- コンテンツ -->
  <main class="container">

    <!-- 関連記事（THE SURF NEWS） -->
    <section id="related" aria-labelledby="related-title">
      <h2 id="related-title" class="section-title">関連記事（THE SURF NEWS）</h2>
      <p class="section-desc">最新の公開記事から4件を自動取得して表示します（サムネ・タイトル・リンクのみ）。</p>

      <!-- スケルトン（初期表示） -->
      <div id="articles" class="articles" aria-live="polite">
        <div class="sk-card">
          <div class="sk-img skeleton"></div>
          <div class="sk-body">
            <div class="sk-line skeleton"></div>
            <div class="sk-line skeleton"></div>
          </div>
        </div>
        <div class="sk-card">
          <div class="sk-img skeleton"></div>
          <div class="sk-body">
            <div class="sk-line skeleton"></div>
            <div class="sk-line skeleton"></div>
          </div>
        </div>
        <div class="sk-card">
          <div class="sk-img skeleton"></div>
          <div class="sk-body">
            <div class="sk-line skeleton"></div>
            <div class="sk-line skeleton"></div>
          </div>
        </div>
        <div class="sk-card">
          <div class="sk-img skeleton"></div>
          <div class="sk-body">
            <div class="sk-line skeleton"></div>
            <div class="sk-line skeleton"></div>
          </div>
        </div>
      </div>

      <div style="margin-top:12px; display:flex; gap:10px; align-items:center;">
        <button id="refresh" class="btn outline" type="button">最新を再取得</button>
        <small style="color:#64748b;">※サーバー側で最大30分キャッシュします。</small>
      </div>
    </section>
  </main>

  <footer class="site-footer">
    <p>© <span id="year"></span> SEA LIFE HUB</p>
  </footer>

  <script>
    document.getElementById('year').textContent = new Date().getFullYear();

    // ===== 記事の取得＆描画 =====
    const API = `${location.origin}/api/surfnews?limit=4`;

    function articleCard(item){
      const date = new Date(item.date);
      const y = date.getFullYear();
      const m = String(date.getMonth()+1).padStart(2,'0');
      const d = String(date.getDate()).padStart(2,'0');
      const badge = item.category || 'News';
      const img = item.image || 'images/diagnosis.jpg';
      return `
        <article class="article-card">
          <a class="article-img-wrap" href="${item.link}" target="_blank" rel="noopener">
            <img class="article-img" src="${img}" alt="${item.title.replace(/"/g,'&quot;')}" loading="lazy" />
          </a>
          <div class="article-body">
            <div class="article-meta">
              <span class="badge">${badge}</span>
              <time datetime="${item.date}">${y}/${m}/${d}</time>
            </div>
            <h3 class="article-title">${item.title}</h3>
            <div class="article-actions">
              <a class="article-link" href="${item.link}" target="_blank" rel="noopener">記事を読む</a>
            </div>
            <div class="mini" style="margin-top:4px;color:#64748b;">出典：THE SURF NEWS</div>
          </div>
        </article>
      `;
    }

    async function loadArticles(){
      const mount = document.getElementById('articles');
      try{
        const res = await fetch(API, { cache: 'no-store' });
        if(!res.ok) throw new Error('HTTP '+res.status);
        const data = await res.json();
        if(!data.ok || !data.items?.length) throw new Error(data.error || 'no items');
        mount.innerHTML = data.items.map(articleCard).join('');
      }catch(e){
        mount.innerHTML = `
          <div style="grid-column:1/-1; padding:12px; border:1px solid rgba(255,0,0,.25); border-radius:12px; background:rgba(255,0,0,.06);">
            最新記事の取得に失敗しました。時間をおいて再読み込みしてください。<br>
            <code style="font-size:.85rem; opacity:.8;">${String(e)}</code>
          </div>`;
      }
    }

    document.getElementById('refresh').addEventListener('click', loadArticles);
    window.addEventListener('load', loadArticles);
  </script>
</body>
</html>
